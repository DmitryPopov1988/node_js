{"version":3,"file":"app.js","sources":["app.ts"],"sourceRoot":"/","sourcesContent":["import express from 'express'\nimport nunjucks from 'nunjucks'\nimport path from 'path'\nimport {env_config} from './config/env_config'\nimport meteorRouter from './router/meteor_router'\nimport roverPhotoRouter from './router/rover_photo_router'\nimport {validator} from './middleware/validator'\nimport {meteorRequestSchema} from './validation/meteor_request_validator';\nimport {userRequestSchema} from './validation/user_request_validator';\nimport {exceptionHandler, pageNotFoundHandler} from './middleware/exception'\nimport {initSentry} from \"./config/sentry_config\";\n\nconst app = express();\nconst Sentry = initSentry(app);\n\nnunjucks.configure(path.resolve(__dirname, './template'), {\n    autoescape: true,\n    express: app,\n});\n\napp.use(express.static(path.join(__dirname, '.', 'public')));\n\napp.use(express.json());\napp.use(express.urlencoded({ extended: true }));\napp.use(Sentry.Handlers.requestHandler());\napp.use(Sentry.Handlers.tracingHandler());\n\napp.get(\"/debug-sentry\", function mainHandler(req, res) {\n    throw new Error(\"My first Sentry error!\");\n});\n\napp.get('/user', (req, res) => {\n    res.sendFile(path.join(__dirname, 'template', 'user_form.html'));\n});\napp.use('/meteors', validator(meteorRequestSchema, 'query'), meteorRouter);\napp.use('/photos', validator(userRequestSchema, 'body'), roverPhotoRouter);\n\napp.use(Sentry.Handlers.errorHandler());\n\napp.use(exceptionHandler);\napp.use('*', pageNotFoundHandler);\n\napp.set('view engine', 'html');\n\nconst port = env_config.appServerConfig.port;\napp.listen(port, () => {\n    console.log(`The server is running on port ${port}`);\n});"],"names":[],"mappings":";;;;;;;AAAA,sDAA6B;AAC7B,wDAA+B;AAC/B,gDAAuB;AACvB,oDAA8C;AAC9C,2EAAiD;AACjD,qFAA0D;AAC1D,sDAAgD;AAChD,oFAA0E;AAC1E,gFAAsE;AACtE,sDAA4E;AAC5E,0DAAkD;AAElD,MAAM,GAAG,GAAG,IAAA,iBAAO,GAAE,CAAC;AACtB,MAAM,MAAM,GAAG,IAAA,0BAAU,EAAC,GAAG,CAAC,CAAC;AAE/B,kBAAQ,CAAC,SAAS,CAAC,cAAI,CAAC,OAAO,CAAC,SAAS,EAAE,YAAY,CAAC,EAAE;IACtD,UAAU,EAAE,IAAI;IAChB,OAAO,EAAE,GAAG;CACf,CAAC,CAAC;AAEH,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,MAAM,CAAC,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,GAAG,EAAE,QAAQ,CAAC,CAAC,CAAC,CAAC;AAE7D,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,IAAI,EAAE,CAAC,CAAC;AACxB,GAAG,CAAC,GAAG,CAAC,iBAAO,CAAC,UAAU,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;AAChD,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC,CAAC;AAC1C,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,cAAc,EAAE,CAAC,CAAC;AAE1C,GAAG,CAAC,GAAG,CAAC,eAAe,EAAE,SAAS,WAAW,CAAC,GAAG,EAAE,GAAG;IAClD,MAAM,IAAI,KAAK,CAAC,wBAAwB,CAAC,CAAC;AAC9C,CAAC,CAAC,CAAC;AAEH,GAAG,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,EAAE;IAC1B,GAAG,CAAC,QAAQ,CAAC,cAAI,CAAC,IAAI,CAAC,SAAS,EAAE,UAAU,EAAE,gBAAgB,CAAC,CAAC,CAAC;AACrE,CAAC,CAAC,CAAC;AACH,GAAG,CAAC,GAAG,CAAC,UAAU,EAAE,IAAA,qBAAS,EAAC,8CAAmB,EAAE,OAAO,CAAC,EAAE,uBAAY,CAAC,CAAC;AAC3E,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,IAAA,qBAAS,EAAC,0CAAiB,EAAE,MAAM,CAAC,EAAE,4BAAgB,CAAC,CAAC;AAE3E,GAAG,CAAC,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,YAAY,EAAE,CAAC,CAAC;AAExC,GAAG,CAAC,GAAG,CAAC,4BAAgB,CAAC,CAAC;AAC1B,GAAG,CAAC,GAAG,CAAC,GAAG,EAAE,+BAAmB,CAAC,CAAC;AAElC,GAAG,CAAC,GAAG,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;AAE/B,MAAM,IAAI,GAAG,uBAAU,CAAC,eAAe,CAAC,IAAI,CAAC;AAC7C,GAAG,CAAC,MAAM,CAAC,IAAI,EAAE,GAAG,EAAE;IAClB,OAAO,CAAC,GAAG,CAAC,iCAAiC,IAAI,EAAE,CAAC,CAAC;AACzD,CAAC,CAAC,CAAC","debug_id":"218d87d4-f115-5f50-9968-de4988565fbd"}